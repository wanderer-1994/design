INSERT INTO `ecommerce`.category_entity (entity_id, name, parent, is_online) VALUES
('wired_earbud', 'Tai nghe dây', 'earbud', '1'),
('sound_accessory', 'Âm thanh', null, '1'),
('earbud', 'Tai nghe nhét tai', 'sound_accessory', '1'),
('wireless_earbud', 'Tai nghe bluetooth', 'earbud', '1'),
('headphone', 'Headphone', 'sound_accessory', '1'),
('powerbank', 'Sạc dự phòng', 'charge_accessory', '1'),
('charge_cable', 'Cáp sạc', 'charge_accessory', '1'),
('power_port', 'Củ sạc', 'charge_accessory', '1'),
('charge_accessory', 'Phụ kiện sạc', null, '1')

### Not work
SELECT GROUP_CONCAT(lv SEPARATOR ',') FROM (
SELECT @pv:=(SELECT GROUP_CONCAT(entity_id SEPARATOR ',') FROM ecommerce.category_entity
WHERE parent IN (@pv)) AS lv FROM ecommerce.category_entity
JOIN
(SELECT @pv:='sound_accessory')tmp
WHERE parent IN (@pv)) a;

### Work
SELECT GROUP_CONCAT(lv SEPARATOR ',') FROM (
SELECT @pv:=(SELECT GROUP_CONCAT(entity_id SEPARATOR ',') FROM ecommerce.category_entity 
WHERE FIND_IN_SET(parent, @pv)) AS lv FROM ecommerce.category_entity 
JOIN
(SELECT @pv:='sound_accessory') tmp
) a;

### Work
with recursive cte (entity_id, name, parent) as (
  select     entity_id,
             name,
             parent
  from       ecommerce.category_entity
  where      entity_id='sound_accessory'
  union all
  select     p.entity_id,
             p.name,
             p.parent
  from       ecommerce.category_entity AS p
  inner join cte
          on p.parent = cte.entity_id
)
select entity_id from cte;

### Investigate
select  entity_id,
        name,
        parent 
from    (select * from ecommerce.category_entity
         order by parent, entity_id) AS cat_sorted,
        (select @pv := 'sound_accessory') initialisation
where   find_in_set(parent, @pv)
and     length(@pv := concat(@pv, ',', entity_id))